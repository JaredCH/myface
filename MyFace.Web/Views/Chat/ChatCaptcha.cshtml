@model MyFace.Web.Models.ChatCaptchaViewModel
@{
    Layout = null;
    ViewData["Title"] = "Chat Captcha";
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <style>
        body { background: #f8fafc; color: #0f172a; font-family: monospace; padding: 1rem; }
        .box { border: 1px solid #cbd5e1; background: #ffffff; padding: 1rem; border-radius: 6px; max-width: 520px; margin: 0 auto; }
        .captcha-panel { background: linear-gradient(135deg, #f97316, #ea580c); color: #fff7ed; border-radius: 10px; padding: 1rem 1.25rem; margin: 1rem 0; box-shadow: 0 12px 28px rgba(15,23,42,0.35); border: 1px solid rgba(250, 204, 21, 0.5); position: relative; }
        .captcha-panel-code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 1.1rem; letter-spacing: 0.08em; text-transform: uppercase; background: rgba(15, 23, 42, 0.35); padding: 0.75rem 0.9rem; border-radius: 8px; margin-bottom: 0.85rem; box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.35); }
        .captcha-panel-question { display: block; margin-bottom: 0.35rem; font-weight: 700; letter-spacing: 0.02em; }
        .captcha-panel-input { width: 100%; padding: 0.45rem 0.65rem; border: 1px solid rgba(255,255,255,0.5); border-radius: 8px; background: rgba(15,23,42,0.25); color: #fff; font-family: inherit; }
        .captcha-panel-input::placeholder { color: rgba(248, 250, 252, 0.65); }
        .captcha-panel-input:focus { outline: none; border-color: #fde68a; box-shadow: 0 0 0 3px rgba(253, 230, 138, 0.35); }
        .captcha-help { position: absolute; bottom: 0.85rem; right: 0.85rem; width: 32px; height: 32px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.6); background: transparent; color: #fff; font-weight: 700; cursor: help; }
        .captcha-help:hover { background: rgba(15,23,42,0.25); }
        .error { background: #fdecec; color: #7f1d1d; border: 1px solid #f5c2c7; padding: 0.5rem 0.75rem; border-radius: 4px; margin-bottom: 0.75rem; }
        .actions { margin-top: 0.75rem; display: flex; gap: 0.5rem; align-items: center; }
        button { padding: 0.45rem 0.9rem; border: 1px solid #0f172a; background: #0f172a; color: #ffffff; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1f2a48; }
        .meta { color: #475569; font-size: 0.9rem; }
    </style>
</head>
<body>
    <div class="box">
        <h2>Chat Captcha</h2>
        <p class="meta">Solve this to send your message.</p>
        @if (!string.IsNullOrEmpty(Model.Error))
        {
            <div class="error">@Model.Error</div>
        }
        <form method="post" asp-action="SolveCaptcha" asp-controller="Chat">
            @Html.AntiForgeryToken()
            <input type="hidden" name="room" value="@Model.Room" />
            <input type="hidden" name="content" value="@Model.Content" />
            @{ var captchaHelpText = "Read the phrase above, then answer the requested word position or simple math. Case insensitive, no punctuation."; }
            <div class="captcha-panel">
                <div class="captcha-panel-code">@Html.Raw(Model.ContextHtml)</div>
                <label class="captcha-panel-question" for="answer">@Model.Question</label>
                <input id="answer" name="answer" type="text" autocomplete="off" class="captcha-panel-input" />
                <button type="button" class="captcha-help" title="@captchaHelpText" aria-label="How to complete this captcha">?</button>
            </div>
            <div class="actions">
                <button type="submit">Submit</button>
                <span class="meta">Attempts remaining: @Model.AttemptsRemaining</span>
            </div>
        </form>
    </div>
</body>
</html>
