@model MyFace.Web.Models.ChatMessagesViewModel
@{
    Layout = null;
    var viewerHandle = (Model.ViewerUsername ?? string.Empty).ToLowerInvariant();
    var hasViewerHandle = !string.IsNullOrWhiteSpace(viewerHandle);
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="refresh" content="5" />
    <style>
        :root {
            --irc-border: rgba(59, 130, 246, 0.35);
            --irc-text: #e2e8f0;
            --irc-muted: #94a3b8;
            --irc-highlight: #38bdf8;
            --irc-danger: #fb7185;
            --irc-gold: #fcd34d;
        }
        html, body { height: 100%; }
        body {
            margin: 0;
            padding: 0.75rem;
            font-family: 'JetBrains Mono', 'Iosevka', 'Ubuntu Mono', monospace;
            font-size: 13px;
            background: transparent;
            color: var(--irc-text);
        }
        .irc-shell {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            height: 100%;
            border: 1px solid var(--irc-border);
            border-radius: 16px;
            padding: 0.75rem;
            background: transparent;
        }
        .irc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-size: 0.75rem;
            color: var(--irc-muted);
        }
        .irc-room {
            font-weight: 700;
            color: var(--irc-highlight);
            font-size: 0.95rem;
        }
        .irc-main {
            flex: 1;
            display: flex;
            min-height: 0;
        }
        .irc-log {
            flex: 1;
            border: 1px solid var(--irc-border);
            border-radius: 14px;
            background: transparent;
            padding: 0.75rem;
            overflow-y: auto;
            min-width: 0;
        }
        .chat-lines { display: flex; flex-direction: column; gap: 0.35rem; }
        .line {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            align-items: baseline;
            white-space: pre-wrap;
            word-break: break-word;
        }
        .ts { color: var(--irc-muted); }
        .user { color: #f8fafc; }
        .user.role-admin { color: #ef4444; }
        .user.role-mod { color: #3b82f6; }
        .user.role-verified,
        .user.role-user { color: #f8fafc; }
        .mention { color: var(--irc-gold); }
        .msg { color: var(--irc-text); flex: 1; }
        .meta { color: var(--irc-muted); font-size: 0.75rem; }
        .paused-banner {
            background: rgba(234, 179, 8, 0.18);
            border: 1px dashed rgba(250, 204, 21, 0.6);
            color: var(--irc-gold);
            padding: 0.45rem 0.65rem;
            border-radius: 10px;
            margin-bottom: 0.6rem;
        }
        @@media (max-width: 720px) {
            body { padding: 0.35rem; }
            .irc-shell { border-radius: 10px; }
            .irc-main { flex-direction: column; }
        }
        @if (!Model.ShowMessageIds)
        {
            <text>.line .meta { display: none; }</text>
        }
        @if (hasViewerHandle)
        {
            <text>body[data-self="@viewerHandle"] .user[data-username="@viewerHandle"] { color: #22c55e !important; }</text>
        }
    </style>
</head>
<body data-self="@viewerHandle">
    <div class="irc-shell">
        <header class="irc-header">
            <div class="irc-room">#@Model.Room</div>
            <div>Auto-refresh Â· 5s</div>
        </header>
        <div class="irc-main">
            <section class="irc-log" aria-live="polite">
                @if (Model.Paused)
                {
                    <div class="paused-banner">Chat is paused. Messages remain visible.</div>
                }
                @Html.Raw(Model.SnapshotHtml)
            </section>
        </div>
    </div>
</body>
</html>
